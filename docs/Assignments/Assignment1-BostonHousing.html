<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Zane Billings">
<meta name="dcterms.date" content="2023-01-22">

<title>cooperative-cobra - Assignment 1: Boston Housing regression model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<link rel="stylesheet" media="screen" href="https://fonts.googleapis.com/css?family=Atkinson+Hyperlegible|Anonymous+Pro" type="text/css">


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">cooperative-cobra</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-notes" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Notes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-notes">    
        <li>
    <a class="dropdown-item" href="../Notes/Module1-TensorBasics.html">
 <span class="dropdown-text">Module 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Notes/Module2-LinearRegression.html">
 <span class="dropdown-text">Module 2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-assignments" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Assignments</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-assignments">    
        <li class="dropdown-header">1. Boston Housing regression</li>
        <li>
    <a class="dropdown-item" href="../Assignments/Assignment1-BostonHousing.html">
 <span class="dropdown-text">Assignment 1: Boston Housing regression model</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/wzbillings/cooperative-cobra/"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://wzbillings.com/"><i class="bi bi-arrow-90deg-up" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-import" id="toc-data-import" class="nav-link active" data-scroll-target="#data-import"><span class="toc-section-number">1</span>  Data Import</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Assignment 1: Boston Housing regression model</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Zane Billings </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 22, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>The original assignment for this section was to find 5 functions in the Pytorch documentation, write about them with examples, and write a Medium post about it <code>r emoji::emoji("eyeroll")</code>. No wonder there’s so many basically useless Medium articles in existence if people like me who have absolutely no idea what they’re doing are basically creating worse versions of all the documentation and good examples that already exist. So I decided to make my own assignment.</p>
<p>I was going to download the dataset from <a href="https://www.kaggle.com/competitions/boston-housing/overview">this kaggle competition</a> linked in the tutorial, but it won’t let me download the dataset, of course. So, I did what any reasonable person would do and found a separate link to the dataset on kaggle, and uploaded it to <a href="https://github.com/wzbillings/datasets/tree/main/BostonHousing">my GitHub</a> so I don’t have to deal with Kaggle’s terrible website or worry about the data link randomly going away. So feel free to play along at home, if you want. Although idk why you would be reading my insane notes instead of just watching the same tutorial that I watched.</p>
<p>But regardless, here’s the raw link to the CSV to save you some time: <a href="https://raw.githubusercontent.com/wzbillings/datasets/main/BostonHousing/HousingData.csv">link</a>.</p>
<section id="data-import" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Data Import</h1>
<p>Ok, so the first thing I have to do is figure out how to load a CSV from a URL into python. Then I have to figure out how to convert that into a <code>torch</code> tensor object. Luckily, I have a lot of patience for this kind of thing. I think I will need <code>pandas</code> for this, so I went ahead and installed it.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the CSV direct from GitHub</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">""</span>.join([</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"https://raw.githubusercontent.com/wzbillings/datasets/main/"</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"BostonHousing/HousingData.csv"</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>housing <span class="op">=</span> pd.read_csv(url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>OK, before I convert to Tensors, I think I need to get rid of the missing data. I’ll do a quick and dirty KNN imputation with 5 neighbors, which is apparently the default in sklearn. Idk how to tune it to choose a better one with this. That’s something to look into in the future.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> KNNImputer</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the imputer</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>imputer <span class="op">=</span> KNNImputer(n_neighbors <span class="op">=</span> <span class="dv">5</span>, weights <span class="op">=</span> <span class="st">"uniform"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>imputed_df <span class="op">=</span> pd.DataFrame(imputer.fit_transform(housing))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>imputed_df.columns <span class="op">=</span> housing.columns</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>imputed_df.index <span class="op">=</span> housing.index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>OK, now I think we can convert to tensor. It kind of annoys me that there is apparently no built-in interoperability between sklearn and pandas.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to TensorDataset</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch.utils.data <span class="im">import</span> TensorDataset</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert from pandas DataFrame to torch tensor</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>inputs <span class="op">=</span> torch.tensor(imputed_df.drop(<span class="st">"MEDV"</span>, axis <span class="op">=</span> <span class="dv">1</span>).values)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>targets <span class="op">=</span> torch.tensor(</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    np.reshape(imputed_df[<span class="st">"MEDV"</span>].values, (<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)),</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make sure both tensors are the same type</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    dtype <span class="op">=</span> inputs.dtype</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ok, that only took a few google searches so I guess I remember more about <code>pandas</code> than I thought. Since there are only <code>r 506 * 14</code> entries in the data frame, I’m not going to worry about batch loading or whatever.</p>
<p>Of course my first instinct as a data scientist is to plot the data, but this course is about tensorflow, not about data visualization in python – that’s another course that I need to take. I started working on this before realizing that you can’t show a nice 14x14 scatterplot grid, and then I tried to slice the dataframe to get the first six columns PLUS the outcome variable. But of course this is apparently a very difficult task in python, even though it would be <code>housing[,c(0:6, 14)]</code> in R. But I found multiple stackoverflow threads talking about how to do this, and apparently the simplest solution is <code>housing[housing.columns[[x for x in range(7)] + [14]]]</code> which is INSANE to me.</p>
<p>But I’ll stop complaining about python again, not being able to easily make a scatterplot is <em>fine</em> I guess.</p>
<p>So, the first thing we need to do is set up the model, loss function, and optimizer. I’ll use the linear neural net and MSE loss just like in the tutorial, since that gives us a standard linear regression model. I looked at the options, and one of them is L-BFGS, which is one of the defaults in <code>R</code> and I quite like it. So let’s use that instead of stochastic gradient descent. It’s not a stochastic method, but since we’re guaranteed to have only one extremum with this problem, it will be good.</p>
<p>I’m not really sure what the best way to choose the learning rate is, so I’ll use the same one from the previous example.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> torch.nn.Linear(housing.shape[<span class="dv">1</span>]<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, dtype <span class="op">=</span> torch.float64)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>loss_fn <span class="op">=</span> torch.nn.functional.mse_loss</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>optim <span class="op">=</span> torch.optim.LBFGS(model.parameters(), lr <span class="op">=</span> <span class="fl">1e-5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>From the <a href="https://pytorch.org/docs/stable/optim.html#optimizer-step-closure">documentation</a>, apparently LBFGS needs a “closure” argument to revaluate the model multiple times, so we have to define that by following the example.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> optim_closure():</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    optim.zero_grad()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    output <span class="op">=</span> model(inputs)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    loss <span class="op">=</span> loss_fn(output, targets)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    loss.backward()</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> loss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we will write our function for fitting the model. I’ll go back to waiting for the error to converge this time, since I think in general that is a better approach than running for a fixed number of epochs. But we can also add a maximum iteration number to terminate at.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fit_model(max_epochs):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" This puts it all together."""</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initiate some constants that will be used in the loop</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    epochs_run <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    loss_diff <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    loss <span class="op">=</span> torch.tensor(<span class="dv">1</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> ((epochs_run <span class="op">&lt;=</span> max_epochs) <span class="kw">and</span> (loss_diff <span class="op">&gt;</span> <span class="fl">1e-4</span>)):</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Save the old loss so we can calculate the difference</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        old_loss <span class="op">=</span> loss</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Fit the model with current parameters</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        pred <span class="op">=</span> model(inputs)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate the loss</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> loss_fn(pred, targets)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Compute the gradients</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        loss.backward()</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Update the parameters with the closure step</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>        optim.step(optim_closure)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reset the gradients</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>        optim.zero_grad()</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate the difference in the loss function</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>        loss_diff <span class="op">=</span> <span class="bu">abs</span>(loss <span class="op">-</span> old_loss)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Increment epochs</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>        epochs_run <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Print current progress every 100th epoch</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (epochs_run) <span class="op">%</span> <span class="dv">100</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Epoch [</span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">], Loss: </span><span class="sc">{:.4f}</span><span class="st">'</span>.<span class="bu">format</span>(</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>                    epochs_run,</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>                    max_epochs,</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>                    loss.item()</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>                flush <span class="op">=</span> <span class="va">True</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If we reached maximum number of epochs before loss converged, report that</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> epochs_run <span class="op">==</span> max_epochs:</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Maximum epochs reached without convergence."</span>, flush <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we run the stuff. It should take <strong>all</strong> that long, so I’m willing to run it for like 10000 iterations while I get up from the computer and walk around. Just remember while this is running, this model would probably take less than a second to fit with a regular linear solution solver.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>fit_model(<span class="fl">1e4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [100/10000.0], Loss: 621.1790</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [200/10000.0], Loss: 598.6065</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [300/10000.0], Loss: 576.8173</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [400/10000.0], Loss: 555.8203</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [500/10000.0], Loss: 535.5941</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [600/10000.0], Loss: 516.1251</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [700/10000.0], Loss: 497.3804</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [800/10000.0], Loss: 479.3326</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [900/10000.0], Loss: 461.9538</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1000/10000.0], Loss: 445.2149</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1100/10000.0], Loss: 429.0900</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1200/10000.0], Loss: 413.5533</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1300/10000.0], Loss: 398.5789</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1400/10000.0], Loss: 384.1466</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1500/10000.0], Loss: 370.2379</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1600/10000.0], Loss: 356.8259</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1700/10000.0], Loss: 343.8998</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1800/10000.0], Loss: 331.4394</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1900/10000.0], Loss: 319.4383</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [2000/10000.0], Loss: 307.8878</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [2100/10000.0], Loss: 296.7706</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [2200/10000.0], Loss: 286.0787</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [2300/10000.0], Loss: 275.7921</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [2400/10000.0], Loss: 265.8972</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [2500/10000.0], Loss: 256.3795</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [2600/10000.0], Loss: 247.2260</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [2700/10000.0], Loss: 238.4395</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [2800/10000.0], Loss: 230.0111</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [2900/10000.0], Loss: 221.9286</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [3000/10000.0], Loss: 214.1719</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [3100/10000.0], Loss: 206.7073</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [3200/10000.0], Loss: 199.5383</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [3300/10000.0], Loss: 192.6485</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [3400/10000.0], Loss: 186.0289</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [3500/10000.0], Loss: 179.6617</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [3600/10000.0], Loss: 173.5416</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [3700/10000.0], Loss: 167.6569</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [3800/10000.0], Loss: 162.0026</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [3900/10000.0], Loss: 156.5712</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [4000/10000.0], Loss: 151.3546</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [4100/10000.0], Loss: 146.3447</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [4200/10000.0], Loss: 141.5333</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [4300/10000.0], Loss: 136.9139</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [4400/10000.0], Loss: 132.4752</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [4500/10000.0], Loss: 128.2115</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [4600/10000.0], Loss: 124.1157</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [4700/10000.0], Loss: 120.1809</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [4800/10000.0], Loss: 116.4008</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [4900/10000.0], Loss: 112.7692</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [5000/10000.0], Loss: 109.2819</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [5100/10000.0], Loss: 105.9304</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [5200/10000.0], Loss: 102.7108</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [5300/10000.0], Loss: 99.6181</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [5400/10000.0], Loss: 96.6474</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [5500/10000.0], Loss: 93.7939</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [5600/10000.0], Loss: 91.0532</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [5700/10000.0], Loss: 88.4219</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [5800/10000.0], Loss: 85.8935</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [5900/10000.0], Loss: 83.4652</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [6000/10000.0], Loss: 81.1330</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [6100/10000.0], Loss: 78.8931</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [6200/10000.0], Loss: 76.7419</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [6300/10000.0], Loss: 74.6760</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [6400/10000.0], Loss: 72.6949</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [6500/10000.0], Loss: 70.7923</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [6600/10000.0], Loss: 68.9644</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [6700/10000.0], Loss: 67.2093</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [6800/10000.0], Loss: 65.5223</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [6900/10000.0], Loss: 63.9038</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [7000/10000.0], Loss: 62.3479</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [7100/10000.0], Loss: 60.8535</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [7200/10000.0], Loss: 59.4184</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [7300/10000.0], Loss: 58.0406</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [7400/10000.0], Loss: 56.7159</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [7500/10000.0], Loss: 55.4448</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [7600/10000.0], Loss: 54.2233</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [7700/10000.0], Loss: 53.0499</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [7800/10000.0], Loss: 51.9212</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [7900/10000.0], Loss: 50.8375</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [8000/10000.0], Loss: 49.7965</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [8100/10000.0], Loss: 48.7974</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [8200/10000.0], Loss: 47.8372</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [8300/10000.0], Loss: 46.9147</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [8400/10000.0], Loss: 46.0289</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [8500/10000.0], Loss: 45.1777</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [8600/10000.0], Loss: 44.3598</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [8700/10000.0], Loss: 43.5745</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [8800/10000.0], Loss: 42.8198</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [8900/10000.0], Loss: 42.0953</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [9000/10000.0], Loss: 41.3988</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [9100/10000.0], Loss: 40.7295</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [9200/10000.0], Loss: 40.0869</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [9300/10000.0], Loss: 39.4693</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [9400/10000.0], Loss: 38.8761</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [9500/10000.0], Loss: 38.3062</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [9600/10000.0], Loss: 37.7580</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [9700/10000.0], Loss: 37.2317</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [9800/10000.0], Loss: 36.7256</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [9900/10000.0], Loss: 36.2385</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [10000/10000.0], Loss: 35.7703</code></pre>
</div>
</div>
<p>OK, so we got down to a reasonable loss. I’m pretty sure we could get a better solution if we ran for longer but let’s take a look at the parameters now.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(model.parameters())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>[Parameter containing:
 tensor([[-0.0804,  0.0209,  0.0188,  0.7246,  0.2983,  4.7973, -0.0196, -0.8471,
           0.1883, -0.0237, -0.2906,  0.0376, -0.3848]], dtype=torch.float64,
        requires_grad=True),
 Parameter containing:
 tensor([0.4049], dtype=torch.float64, requires_grad=True)]</code></pre>
</div>
</div>
<p>It’s important to remember that the first entry here is the vector of slope coefficients, and the bias is the intercept. We can compare this to a regular regression model. I’ll even do it by hand just to show how much we should not be doing linear regression this way using tensors and a numerical optimizer.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a vector of ones -- these are used to estimate the "bias".</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>ones <span class="op">=</span> torch.tensor(np.ones(shape <span class="op">=</span> [<span class="dv">506</span>, <span class="dv">1</span>]))</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the vector of ones as the first column of the imputed input tensor.</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>i2 <span class="op">=</span> torch.cat((ones, inputs), dim <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the analytical solution: (X^T X)^-1 X^T y.</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>soln <span class="op">=</span> torch.linalg.inv(i2.t() <span class="op">@</span> i2) <span class="op">@</span> i2.t() <span class="op">@</span> targets</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the predictions: just X beta_hat</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>soln_preds <span class="op">=</span> i2 <span class="op">@</span> soln</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a><span class="co"># And now calculate the MSE for the analytical solution vs. the one that</span></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ran for 10000 iterations.</span></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>soln_mse <span class="op">=</span> loss_fn(soln_preds, targets)</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>optim_mse <span class="op">=</span> loss_fn(model(inputs), targets)</span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Analytical solution: </span><span class="sc">{:.4f}</span><span class="st">"</span>.<span class="bu">format</span>(soln_mse),</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Numerical solution:  </span><span class="sc">{:.4f}</span><span class="st">"</span>.<span class="bu">format</span>(optim_mse),</span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>    sep <span class="op">=</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analytical solution: 22.0090
Numerical solution:  35.7610</code></pre>
</div>
</div>
<p>That’s a pretty big difference <code>r emoji::emoji("smile")</code>. I guess it goes to show that good old-fashioned statistics is often way faster than these fancy methods that people seem to like. Like I said, it really worries me that this numerical approach seems to be a lot of tech/DS enthusiast’s first intro to linear regression, and it’s really not very good. But I believe in the next exercises we’ll get into some problems that actually need these types of models. That’s all for now!</p>
<!-- END OF FILE -->


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>